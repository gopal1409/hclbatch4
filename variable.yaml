---
# yaml document begin with document seprator
  - #this minus indicate list of item in python
    #the target where your play will run
    hosts: db1
    vars:
      web_pkg: httpd
      firewall_pkg: firewalld
      perl_pkg: perl
      rule: http
    tasks:
      - name: install packages
        yum:
          name:
            - "{{ web_pkg }}"
            - "{{ firewall_pkg }}"
            - "{{ perl_pkg }}"
          state: latest
      - name: start and enable service httpd
        service:
          name: "{{ web_pkg }}"
          enabled: true
          state: started
      - name: start and enable firewalld
        service:
          name: "{{ firewall_pkg }}"        
          enabled: true
          state: started
      - name: create web content
        copy:
          content: "Welcome to Ansible Autmation Class"
          dest: /var/www/html/index.html
      - name: open the port for {{ rule }}
        firewalld:
        service: "{{ rule }}"
        permanent: true
        immediate: true
        state: enabled
      - name: Define Web Servername
        lineinfile:
          path: /etc/httpd/conf/httpd.conf
          line: ServerName www.client1.example.com:80
          insertafter: "#ServerName"
      - name: Update the entry in hostfile
        lineinfile:
          path: /etc/hosts
          line: 34.23.255 wwww.client1.example.com
